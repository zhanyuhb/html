<!DOCTYPE html>
<html>
<head>
    <title>å†€æ•™ç‰ˆä¸‰å¹´çº§è‹±è¯­ä¸‹å†Œå•å…ƒç»ƒä¹ </title>
    <style>
        body { 
            font-family: "å¹¼åœ†", Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #d4edce, #fff);
        }
        .header {
            text-align: center;
            margin: 30px 0;
        }
        .word-container {
            display: flex;
            gap: 8px;
            font-size: 28px;
            justify-content: center;
            margin: 30px 0;
        }
        .letter-input {
            width: 40px;
            height: 40px;
            text-align: center;
            font-size: 20px;
            border: 2px solid #4CAF50;
            border-radius: 8px;
            background: #f0f8e9;
            transition: 0.3s;
        }
        .letter-input.error {
            border-color: #ff4444;
            animation: shake 0.5s;
        }
        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            50% { transform: translateX(3px); }
            75% { transform: translateX(-3px); }
            100% { transform: translateX(0); }
        }
        .chinese-meaning {
            font-size: 18px;
            color: #333;
            margin: 15px 0;
            text-align: center;
        }
        button {
            background: #4CAF50;
            color: white;
            padding: 10px 25px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        .disabled {
            background: #cccccc;
            cursor: not-allowed;
        }
        .feedback {
            color: #ff4444;
            text-align: center;
            margin: 15px;
        }
        .result-box {
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .audio-icon {
            font-size: 24px;
            color: #4CAF50;
            cursor: pointer;
            margin-left: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>ğŸ“– å†€æ•™ç‰ˆä¸‰å¹´çº§è‹±è¯­ä¸‹å†Œç»ƒä¹  ğŸ“–</h1>
    </div>
    
    <div class="container">
        <label>é€‰æ‹©å•å…ƒï¼š</label>
        <select id="unitSelect">
            <option value="0">Unit 1 Food and Numbers</option>
            <option value="1">Unit 2 Meals</option>
            <option value="2">Unit 3 Daily Routines</option>
            <option value="3">Unit 4 Farm Animals</option>
            <option value="4">Unit 5 Zoo Animals</option>
            <option value="5">Unit 6 Days of the Week</option>
        </select>
        <button onclick="startPractice()">å¼€å§‹ç»ƒä¹ </button>
    </div>

    <div id="practiceArea" style="display:none">
        <div class="word-container" id="wordContainer"></div>
        <div class="chinese-meaning" id="chineseMeaning"></div>
        <div class="button-group">
            <button onclick="checkAnswer()" id="submitButton">æäº¤ç­”æ¡ˆ</button>
            <button onclick="nextWord()" id="nextButton" class="disabled" disabled>ä¸‹ä¸€ä¸ª</button>
        </div>
        <div id="feedback" class="feedback"></div>
    </div>

    <div id="finalResult" class="result-box" style="display:none">
        <h3>ç»ƒä¹ ç»“æœ</h3>
        <p>âœ… æ­£ç¡®ï¼š<span id="correctCount"></span></p>
        <p>âŒ é”™è¯¯ï¼š<span id="wrongCount"></span></p>
        <div id="errorWordsSection">
            <h4>éœ€è¦åŠ å¼ºçš„å•è¯ï¼š</h4>
            <ul id="errorWordsList"></ul>
        </div>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {});

// å•å…ƒæ•°æ®ï¼ˆå†€æ•™ç‰ˆä¸‰å¹´çº§ä¸‹å†Œå•è¯è¡¨ï¼‰
const unitData = [ 
    // Unit 1 Food and Numbers
    [["like", "å–œæ¬¢"], ["apple", "è‹¹æœ"], ["orange", "æ©™å­"],
     ["rice", "ç±³é¥­"], ["vegetable", "è”¬èœ"], ["meat", "è‚‰"],
     ["food", "é£Ÿç‰©"], ["fruit", "æ°´æœ"], ["banana", "é¦™è•‰"],
     ["grape", "è‘¡è„"], ["eleven", "åä¸€"], ["twelve", "åäºŒ"],
     ["bread", "é¢åŒ…"], ["my", "æˆ‘çš„"], ["favourite", "ç‰¹åˆ«å–œçˆ±çš„"],
     ["chicken", "é¸¡è‚‰"], ["fish", "é±¼è‚‰"]],
    // Unit 2 Meals
    [["breakfast", "æ—©é¤"], ["egg", "é¸¡è›‹"], ["juice", "æœæ±"],
     ["milk", "ç‰›å¥¶"], ["lunch", "åˆé¤"], ["hungry", "é¥¥é¥¿çš„"],
     ["noodle", "é¢æ¡"], ["water", "æ°´"], ["eat", "åƒ"],
     ["drink", "å–"], ["soup", "æ±¤"], ["dinner", "æ™šé¤"],
     ["good", "å¥½çš„"]],
    // Unit 3 Daily Routines
    [["morning", "æ—©æ™¨"], ["get up", "èµ·åºŠ"], ["make my bed", "æ•´ç†åºŠé“º"],
     ["wash", "æ´—"], ["evening", "æ™šä¸Š"], ["do", "åš"],
     ["schoolbag", "ä¹¦åŒ…"], ["put", "æ”¾"], ["clean", "å¹²å‡€çš„"],
     ["tidy", "æ•´æ´çš„"], ["room", "æˆ¿é—´"], ["sock", "çŸ­è¢œ"]],
    // Unit 4 Farm Animals
    [["farm", "å†œåœº"], ["river", "æ²³"], ["see", "çœ‹è§"],
     ["horse", "é©¬"], ["cow", "å¥¶ç‰›"], ["pig", "çŒª"],
     ["rabbit", "å…”å­"], ["sheep", "ç»µç¾Š"], ["duck", "é¸­"],
     ["bird", "é¸Ÿ"], ["tree", "æ ‘"], ["thirteen", "åä¸‰"],
     ["fourteen", "åå››"], ["fifteen", "åäº”"], ["sixteen", "åå…­"],
     ["seventeen", "åä¸ƒ"], ["eighteen", "åå…«"], ["nineteen", "åä¹"],
     ["twenty", "äºŒå"], ["animal", "åŠ¨ç‰©"], ["many", "è®¸å¤š"]],
    // Unit 5 Zoo Animals
    [["zoo", "åŠ¨ç‰©å›­"], ["panda", "ç†ŠçŒ«"], ["it", "å®ƒ"],
     ["white", "ç™½è‰²"], ["elephant", "è±¡"], ["tiger", "è€è™"],
     ["bear", "ç†Š"], ["monkey", "çŒ´å­"], ["plant", "æ¤ç‰©"],
     ["cute", "å¯çˆ±çš„"], ["its", "å®ƒçš„"], ["can", "èƒ½"],
     ["swim", "æ¸¸æ³³"]],
    // Unit 6 Days of the Week
    [["day", "å¤©"], ["week", "å‘¨"], ["Sunday", "æ˜ŸæœŸæ—¥"],
     ["Monday", "æ˜ŸæœŸä¸€"], ["Tuesday", "æ˜ŸæœŸäºŒ"], ["Wednesday", "æ˜ŸæœŸä¸‰"],
     ["Thursday", "æ˜ŸæœŸå››"], ["Friday", "æ˜ŸæœŸäº”"], ["Saturday", "æ˜ŸæœŸå…­"],
     ["time", "æ—¶é—´"], ["thirty", "ä¸‰å"], ["forty", "å››å"],
     ["ball", "çƒ"], ["dog", "ç‹—"], ["at", "åœ¨"],
     ["early", "ææ—©çš„"]]
];

let currentUnit = 0;
let currentWordIndex = 0;
let correctCount = 0;
let wrongCount = 0;
let answerLetters = [];
let errorWords = [];
let attemptCount = 0;

function startPractice() {
    currentUnit = parseInt(document.getElementById('unitSelect').value);
    currentWordIndex = 0;
    correctCount = 0;
    wrongCount = 0;
    errorWords = [];
    attemptCount = 0;
    
    document.getElementById('practiceArea').style.display = 'block';
    document.getElementById('finalResult').style.display = 'none';
    document.getElementById('nextButton').disabled = true;
    document.getElementById('nextButton').classList.add('disabled');
    
    showNextWord();
}

function showNextWord() {
    if (currentWordIndex >= unitData[currentUnit].length) {
        endPractice();
        return;
    }

    const wordInfo = unitData[currentUnit][currentWordIndex];
    const word = wordInfo[0];
    const chinese = wordInfo[1];
    
    const letters = word.split('');
    const maskCount = Math.floor(Math.random() * 3) + 1; // éšè— 1-3 ä¸ªå­—æ¯
    const maskedPositions = selectMaskedPositions(letters, maskCount);
    
    const container = document.getElementById('wordContainer');
    container.innerHTML = '';
    answerLetters = [];
    
    letters.forEach((letter, index) => {
        if (maskedPositions.has(index)) {
            const input = document.createElement('input');
            input.className = 'letter-input';
            input.maxLength = 1;
            input.dataset.correct = letter;
            container.appendChild(input);
            answerLetters.push(input);
        } else {
            const span = document.createElement('span');
            span.textContent = letter;
            container.appendChild(span);
        }
    });

    // æ·»åŠ ä¸­æ–‡é‡Šä¹‰å’Œå–‡å­å›¾æ ‡
    const meaningContainer = document.getElementById('chineseMeaning');
    meaningContainer.innerHTML = `${chinese} `;
    
    const audioIcon = document.createElement('span');
    audioIcon.className = 'audio-icon';
    audioIcon.innerHTML = 'ğŸ“¢'; // ä½¿ç”¨å–‡å­ç¬¦å·ä½œä¸ºå›¾æ ‡
    audioIcon.onclick = () => speakWord(word);
    meaningContainer.appendChild(audioIcon);

    document.getElementById('feedback').textContent = '';
    answerLetters.forEach(input => input.classList.remove('error'));
    document.getElementById('submitButton').disabled = false;
    document.getElementById('nextButton').disabled = true;
    document.getElementById('nextButton').classList.add('disabled');
    attemptCount = 0;
}

// ä¼˜å…ˆé€‰æ‹©å…ƒéŸ³å­—æ¯å¹¶è·³è¿‡ç©ºæ ¼
function selectMaskedPositions(letters, maskCount) {
    const vowels = new Set(['a', 'e', 'i', 'o', 'u']);
    const maskedPositions = new Set();
    const vowelIndices = [];
    const consonantIndices = [];

    // åˆ†ç¦»å…ƒéŸ³å’Œè¾…éŸ³çš„ç´¢å¼•
    letters.forEach((letter, index) => {
        if (vowels.has(letter.toLowerCase())) {
            vowelIndices.push(index);
        } else if (letter.trim() !== '') { // è·³è¿‡ç©ºæ ¼
            consonantIndices.push(index);
        }
    });

    // ä¼˜å…ˆé€‰æ‹©å…ƒéŸ³å­—æ¯
    while (maskedPositions.size < maskCount && vowelIndices.length > 0) {
        const randomIndex = Math.floor(Math.random() * vowelIndices.length);
        maskedPositions.add(vowelIndices[randomIndex]);
        vowelIndices.splice(randomIndex, 1);
    }

    // å¦‚æœå…ƒéŸ³ä¸å¤Ÿï¼Œè¡¥å……è¾…éŸ³å­—æ¯
    while (maskedPositions.size < maskCount && consonantIndices.length > 0) {
        const randomIndex = Math.floor(Math.random() * consonantIndices.length);
        maskedPositions.add(consonantIndices[randomIndex]);
        consonantIndices.splice(randomIndex, 1);
    }

    return maskedPositions;
}

function checkAnswer() {
    const userAnswer = answerLetters.map(input => input.value.toLowerCase());
    const correctAnswer = answerLetters.map(input => input.dataset.correct.toLowerCase());
    
    if (userAnswer.join('') === correctAnswer.join('')) {
        correctCount++;
        currentWordIndex++;
        showNextWord();
    } else {
        attemptCount++;
        answerLetters.forEach(input => {
            if (input.value.toLowerCase() !== input.dataset.correct.toLowerCase()) {
                input.classList.add('error');
            }
        });
        
        if (attemptCount === 1) {
            document.getElementById('feedback').textContent = 'éƒ¨åˆ†å­—æ¯é”™è¯¯ï¼Œè¯·å†è¯•ä¸€æ¬¡ï¼';
            document.getElementById('submitButton').disabled = false;
        } else {
            wrongCount++;
            document.getElementById('feedback').innerHTML = 
                `æ­£ç¡®ç­”æ¡ˆæ˜¯ï¼š<span style="color: #4CAF50;">${correctAnswer.join('')}</span>`;
            answerLetters.forEach(input => {
                input.value = input.dataset.correct;
                input.disabled = true;
                input.classList.remove('error');
            });
            document.getElementById('submitButton').disabled = true;
            document.getElementById('nextButton').disabled = false;
            document.getElementById('nextButton').classList.remove('disabled');
            if (!errorWords.includes(unitData[currentUnit][currentWordIndex][0])) {
                errorWords.push(unitData[currentUnit][currentWordIndex][0]);
            }
        }
    }
}

function nextWord() {
    currentWordIndex++;
    showNextWord();
}

function endPractice() {
    document.getElementById('practiceArea').style.display = 'none';
    document.getElementById('finalResult').style.display = 'block';
    
    document.getElementById('correctCount').textContent = correctCount;
    document.getElementById('wrongCount').textContent = wrongCount;
    
    const errorSection = document.getElementById('errorWordsSection');
    const errorList = document.getElementById('errorWordsList');
    errorList.innerHTML = '';
    
    if (errorWords.length > 0) {
        errorSection.style.display = 'block';
        errorWords.forEach(word => {
            const li = document.createElement('li');
            li.textContent = word;
            errorList.appendChild(li);
        });
    } else {
        errorSection.style.display = 'none';
    }
}

// ä½¿ç”¨ Web Speech API æ’­æ”¾å•è¯è¯»éŸ³
function speakWord(word) {
    const utterance = new SpeechSynthesisUtterance(word);
    utterance.lang = 'en-US'; // è®¾ç½®è¯­è¨€ä¸ºç¾å¼è‹±è¯­
    speechSynthesis.speak(utterance);
}
</script>
</body>
</html>